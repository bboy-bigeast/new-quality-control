# 胶粘剂产品功能说明

## 功能概述

本系统新增了胶粘剂产品的质量管理功能，支持对胶粘剂产品的理化性能和胶带性能进行全面的质量控制和判定。

## 主要特性

### 1. 双检测人系统
- **理化检测人**：负责理化性能检测
- **胶带检测人**：负责胶带性能检测
- 分别记录检测日期

### 2. 双重判定机制
- **理化性能判定**：基于理化检测数据
- **胶带性能判定**：基于胶带检测数据  
- **最终判定**：综合理化性能和胶带性能的结果

### 3. 检测项目

#### 理化性能检测项目：
- 外观 (appearance)
- 固含 (solid_content)
- 粘度 (viscosity)
- 酸值 (acid_value)
- 水分 (moisture)
- 残单 (residual_monomer)
- 重均分子量 (weight_avg_molecular_weight)
- PDI (pdi)
- 色度 (color)

#### 胶带性能检测项目：
- 初粘 (initial_tack)
- 剥离 (peel_strength)
- 高温持粘 (high_temperature_holding)
- 常温持粘 (room_temperature_holding)
- 定荷重剥离 (constant_load_peel)

### 4. 自动判定逻辑

系统根据产品标准自动进行判定：

1. **数据完整性检查**：检查所有必填检测项目是否完成
2. **合格性检查**：检查检测值是否在标准范围内
3. **综合判定**：
   - 理化合格 + 胶带合格 = 最终合格
   - 理化不合格 或 胶带不合格 = 最终不合格
   - 任一检测未完成 = 最终未完成

## 使用指南

### 1. 设置产品标准

在管理后台的"产品标准"页面，为胶粘剂产品设置检测标准：

```python
# 示例：设置ADH-100产品的固含标准
ProductStandard.objects.create(
    product_code='ADH-100',
    test_item='solid_content',
    standard_type='external_control',
    lower_limit=45.0,
    upper_limit=55.0
)
```

### 2. 录入胶粘剂产品数据

在管理后台的"胶粘剂产品"页面添加新产品：

- 填写产品基本信息（牌号、批号、产线等）
- 填写理化检测数据和检测人信息
- 填写胶带检测数据和检测人信息
- 系统会自动进行判定

### 3. 查看判定结果

系统会自动显示：
- 理化性能判定结果
- 胶带性能判定结果  
- 最终判定结果
- 详细的判定详情（包括不合格项目和具体数值）

### 4. 历史记录追踪

所有修改操作都会自动记录历史，包括：
- 修改人
- 修改时间
- 修改原因
- 具体的修改数据

## 技术实现

### 数据模型
- `AdhesiveProduct`: 胶粘剂产品主模型
- `AdhesiveProductHistory`: 修改历史记录模型

### 自动判定算法
在`save()`方法中自动调用`calculate_judgments()`进行判定：
1. 获取相关标准
2. 检查数据完整性
3. 进行合格性判定
4. 生成最终判定结果

### 管理界面
- 专用的Admin类提供友好的管理界面
- 支持批量操作和搜索
- 提供复制文本功能方便数据导出

## 常见问题

### Q: 为什么历史记录数量为0？
A: 历史记录只在修改操作时创建，首次创建产品不会产生历史记录。

### Q: 如何修改判定标准？
A: 在"产品标准"页面修改相应项目的上下限值。

### Q: 支持哪些样品类别？
A: 支持"单批样"、"装车样"、"掺桶样"三种类别。
